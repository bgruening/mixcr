"split-seq-vdj-3gex-base":
  pipeline:
    inheritFrom: pipeline-single-cell-shotgun
  align:
    inheritFrom: align-kaligner2-single-cell-v1
  refineTagsAndSort:
    whitelists:
      CELL1: builtin:parse-bio-cell1
      CELL2: builtin:parse-bio-cell2
    runCorrection: true
    parameters:
      correctionPower: 0.001
      backgroundSubstitutionRate: 0.001
      backgroundIndelRate: 1.0e-05
      minQuality: 12
      maxSubstitutions: 2
      maxIndels: 2
      maxTotalErrors: 3
  assemblePartial:
    inheritFrom: assemblePartial-universal
  assemble:
    inheritFrom: assemble-base-with-consensus
    overrides:
      clnaOutput: true
  assembleContigs:
    inheritFrom: assembleContigs-universal
  exportAlignments:
    inheritFrom: exportAlignments-base
  exportClones:
    chains: ALL
    splitFilesBy: [ ]
    fields:
      - field: "-cloneId"
      - field: "-tag"
        args: [ "CELL1" ]
      - field: "-tag"
        args: [ "CELL2" ]
      - field: "-tag"
        args: [ "CELL3" ]
      - field: "-readCount"
      - field: "-uniqueTagCount"
        args: [ "UMI" ]
      - field: "-targetSequences"
      - field: "-targetQualities"
      - field: "-vHitsWithScore"
      - field: "-dHitsWithScore"
      - field: "-jHitsWithScore"
      - field: "-cHitsWithScore"
      - field: "-vAlignments"
      - field: "-dAlignments"
      - field: "-jAlignments"
      - field: "-cAlignments"
      - field: "-nFeature"
        args: [ "FR1" ]
      - field: "-minFeatureQuality"
        args: [ "FR1" ]
      - field: "-nFeature"
        args: [ "CDR1" ]
      - field: "-minFeatureQuality"
        args: [ "CDR1" ]
      - field: "-nFeature"
        args: [ "FR2" ]
      - field: "-minFeatureQuality"
        args: [ "FR2" ]
      - field: "-nFeature"
        args: [ "CDR2" ]
      - field: "-minFeatureQuality"
        args: [ "CDR2" ]
      - field: "-nFeature"
        args: [ "FR3" ]
      - field: "-minFeatureQuality"
        args: [ "FR3" ]
      - field: "-nFeature"
        args: [ "CDR3" ]
      - field: "-minFeatureQuality"
        args: [ "CDR3" ]
      - field: "-nFeature"
        args: [ "FR4" ]
      - field: "-minFeatureQuality"
        args: [ "FR4" ]
      - field: "-aaFeature"
        args: [ "FR1" ]
      - field: "-aaFeature"
        args: [ "CDR1" ]
      - field: "-aaFeature"
        args: [ "FR2" ]
      - field: "-aaFeature"
        args: [ "CDR2" ]
      - field: "-aaFeature"
        args: [ "FR3" ]
      - field: "-aaFeature"
        args: [ "CDR3" ]
      - field: "-aaFeature"
        args: [ "FR4" ]
      - field: "-defaultAnchorPoints"

"parse-bio-vdj-3gex":
  inheritFrom: split-seq-vdj-3gex-base
  mixins:
    - type: SetTagPattern
      tagPattern: ^(R1:*)\^(UMI:N{10})(CELL1:N{8})gtggccgatgN{20}(CELL2:N{8})atccacgtgcN{12}(CELL3:N{8})

"split-seq-vdj-3gex":
  inheritFrom: split-seq-vdj-3gex-base
  mixins:
    - type: SetTagPattern
      tagPattern: ^(R1:*)\^(UMI:N{10})(CELL1:N{8})gtggccgatgN{20}(CELL2:N{8})atccacgtgcN{20}(CELL3:N{8})